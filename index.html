<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Ramais - SEDES</title>
    <style>
        /* ... (mantenha todo o CSS anterior igual) ... */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Lista de Ramais - SEDES</h1>
            <p class="subtitle">Secretaria de Desenvolvimento Social</p>
            <button class="admin-login-btn" id="adminLoginBtn">Admin</button>
        </header>
        
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Buscar por ramal, departamento ou setor...">
            <div class="filters">
                <button class="filter-btn active" data-filter="all">Todos</button>
                <button class="filter-btn" data-filter="Gabinete">Gabinete</button>
                <button class="filter-btn" data-filter="Departamento">Departamentos</button>
                <button class="filter-btn" data-filter="Conselho">Conselhos</button>
                <button class="filter-btn" data-filter="Assessoria">Assessorias</button>
            </div>
        </div>
        
        <div class="content" id="content">
            <div class="debug-info" id="debugInfo">
                Carregando dados...
            </div>
        </div>
        
        <footer>
            <p>Atualizado em 2023 | Secretaria de Desenvolvimento Social</p>
        </footer>
    </div>

    <!-- Modais (mantenha igual) -->
    <div class="modal" id="loginModal">
        <!-- ... conteúdo do modal login ... -->
    </div>

    <div class="modal" id="editModal">
        <!-- ... conteúdo do modal edição ... -->
    </div>

    <script>
        // Dados completos dos ramais - CORRIGIDO
        let ramais = JSON.parse(localStorage.getItem('ramais_sedes')) || [
            {ramal: "6555", unidade: "Gabinete", departamento: "UEAPI - Unidade Especial de Atenção ao Idoso", setor: "Unidade Especial de Unidade Especial de Atenção ao Idoso"},
            {ramal: "6404", unidade: "Gabinete", departamento: "SECRETÁRIO ADJUNTO", setor: "Gabinete Secretário Adjunto"},
            {ramal: "6408", unidade: "Gabinete", departamento: "SECRETÁRIO ADJUNTO", setor: "Gabinete Secretário Adjunto"},
            {ramal: "6400", unidade: "Gabinete", departamento: "Recepção / Telefonista", setor: "Recepção SEDES"},
            {ramal: "6411", unidade: "Gabinete", departamento: "Gabinete Secretário", setor: "Apoio Gabinete Secretário"},
            {ramal: "6420", unidade: "Gabinete", departamento: "Gabinete Secretário", setor: "Apoio Gabinete Secretário"},
            {ramal: "6430", unidade: "Gabinete", departamento: "Gabinete Secretário", setor: "Apoio Gabinete Secretário"},
            {ramal: "6432", unidade: "Gabinete", departamento: "Gabinete Secretário", setor: "Apoio Gabinete Secretário"},
            {ramal: "6433", unidade: "Gabinete", departamento: "Gabinete Secretário", setor: "Apoio Gabinete Secretário"},
            {ramal: "6435", unidade: "Gabinete", departamento: "Gabinete Secretário", setor: "Chefia de Gabinete"},
            {ramal: "6402", unidade: "Departamento", departamento: "Departamento de Segurança Alimentar", setor: "Departamento de Segurança Alimentar"},
            {ramal: "6403", unidade: "Departamento", departamento: "Departamento de Segurança Alimentar", setor: "Departamento de Segurança Alimentar"},
            {ramal: "6405", unidade: "Departamento", departamento: "Departamento de Segurança Alimentar", setor: "Departamento de Segurança Alimentar"},
            {ramal: "6406", unidade: "Departamento", departamento: "Departamento de Segurança Alimentar", setor: "Departamento de Segurança Alimentar"},
            {ramal: "6407", unidade: "Departamento", departamento: "Departamento de Segurança Alimentar", setor: "Departamento de Segurança Alimentar"},
            {ramal: "6409", unidade: "Departamento", departamento: "Departamento de Segurança Alimentar", setor: "Departamento de Segurança Alimentar"},
            {ramal: "6426", unidade: "Departamento", departamento: "Departamento de Segurança Alimentar", setor: "Departamento de Segurança Alimentar"},
            {ramal: "6423", unidade: "Departamento", departamento: "Departamento de Politicas para Juventude", setor: "Departamento de Politicas para Juventude"},
            {ramal: "6475", unidade: "Departamento", departamento: "Departamento de Politicas para Juventude", setor: "Diretor de Departamento"},
            {ramal: "6487", unidade: "Departamento", departamento: "Departamento de Politicas para Juventude", setor: "Departamento de Politicas para Juventude"},
            {ramal: "6551", unidade: "Departamento", departamento: "Departamento de Politicas para Juventude", setor: "Departamento de Politicas para Juventude"},
            {ramal: "6552", unidade: "Departamento", departamento: "Departamento de Politicas para Juventude", setor: "Diretor Adjunto"},
            {ramal: "6553", unidade: "Departamento", departamento: "Departamento de Politicas para Juventude", setor: "Departamento de Politicas para Juventude"},
            {ramal: "6412", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimônio e Apoio Protocolo"},
            {ramal: "6413", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimônio e Apoio Protocolo"},
            {ramal: "6466", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimônio e Apoio Protocolo"},
            {ramal: "6491", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimônio e Apoio Protocolo"},
            {ramal: "6572", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimônio e Apoio Protocolo"},
            {ramal: "6414", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Planejamento de Programas"},
            {ramal: "6418", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Inclusão Socioprodutiva"},
            {ramal: "6428", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Inclusão Socioprodutiva"},
            {ramal: "6460", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Inclusão Socioprodutiva"},
            {ramal: "6500", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Registro"},
            {ramal: "6501", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Registro"},
            {ramal: "6502", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Registro"},
            {ramal: "6503", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Registro"},
            {ramal: "6441", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Coordenação do Pró-Social"},
            {ramal: "6442", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Coordenação do Pró-Social"},
            {ramal: "6454", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Coordenação do Pró-Social"},
            {ramal: "6471", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Coordenação do Pró-Social"},
            {ramal: "6529", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Divisão de Coordenação do Pró-Social"},
            {ramal: "6410", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Geral Departamento"},
            {ramal: "6465", unidade: "Departamento", departamento: "Departamento de Inclusão Socioprodutiva e Projetos Especiais", setor: "Diretor de Departamento"},
            {ramal: "6508", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Vigilância Socioassistencial"},
            {ramal: "6519", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Vigilância Socioassistencial"},
            {ramal: "6526", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Vigilância Socioassistencial"},
            {ramal: "6472", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Regulação do SUAS"},
            {ramal: "6476", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Regulação do SUAS"},
            {ramal: "6489", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do SUAS"},
            {ramal: "6518", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Gestão do Trabalho"},
            {ramal: "6457", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão de Benefícios"},
            {ramal: "6455", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do FEAS"},
            {ramal: "6470", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Diretoria do Departamento"},
            {ramal: "6550", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do FEAS"},
            {ramal: "6554", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do FEAS"},
            {ramal: "6438", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do FEAS"},
            {ramal: "6440", unidade: "Gabinete", departamento: "Direção Geral", setor: "Direção Geral"},
            {ramal: "6444", unidade: "Gabinete", departamento: "Direção Geral", setor: "Direção Geral"},
            {ramal: "6474", unidade: "Gabinete", departamento: "Direção Geral", setor: "Direção Geral"},
            {ramal: "6556", unidade: "Gabinete", departamento: "Direção Geral", setor: "Direção Geral"},
            {ramal: "6446", unidade: "Gabinete", departamento: "Direção Geral", setor: "Direção Geral"},
            {ramal: "6458", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Especial - Alta Complexidade"},
            {ramal: "6496", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Especial - Média Complexidade"},
            {ramal: "6512", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Especial - Alta Complexidade"},
            {ramal: "6513", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Especial"},
            {ramal: "6514", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Especial - Média Complexidade"},
            {ramal: "6515", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Especial"},
            {ramal: "6517", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Especial - Alta Complexidade"},
            {ramal: "6538", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Especial - Média Complexidade"},
            {ramal: "6549", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Especial - Alta Complexidade"},
            {ramal: "6456", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Básica do SUAS"},
            {ramal: "6537", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Básica do SUAS"},
            {ramal: "6539", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Básica do SUAS"},
            {ramal: "6547", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Básica do SUAS"},
            {ramal: "6548", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Básica do SUAS"},
            {ramal: "6557", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Proteção Social Básica do SUAS"},
            {ramal: "6452", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Diretoria do Departamento"},
            {ramal: "6540", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Diretoria do Departamento"},
            {ramal: "6453", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Diretoria do Departamento"},
            {ramal: "6490", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do SUAS"},
            {ramal: "6499", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do SUAS"},
            {ramal: "6506", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do SUAS"},
            {ramal: "6544", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão do SUAS"},
            {ramal: "6429", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Vigilância Socioassistencial"},
            {ramal: "6439", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão Estadual do Cadastro Único e Programa Bolsa Família"},
            {ramal: "6445", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão Estadual do Cadastro Único e Programa Bolsa Família"},
            {ramal: "6483", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão Estadual do Cadastro Único e Programa Bolsa Família"},
            {ramal: "6497", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão Estadual do Cadastro Único e Programa Bolsa Família"},
            {ramal: "6498", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão Estadual do Cadastro Único e Programa Bolsa Família"},
            {ramal: "6535", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão Estadual do Cadastro Único e Programa Bolsa Família"},
            {ramal: "6447", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "Divisão de Gestão Estadual do Cadastro Único e Programa Bolsa Família"},
            {ramal: "6419", unidade: "Departamento", departamento: "Departamento de Assistência Social", setor: "DAS - Divisão de Gestão Cadastro Único"},
            {ramal: "6462", unidade: "Departamento", departamento: "Departamento de Atenção a Primeira Infancia", setor: "Departamento de Atenção a Primeira Infancia"},
            {ramal: "6463", unidade: "Departamento", departamento: "Departamento de Atenção a Primeira Infancia", setor: "Departamento de Atenção a Primeira Infancia"},
            {ramal: "6481", unidade: "Departamento", departamento: "Departamento de Atenção a Primeira Infancia", setor: "Departamento de Atenção a Primeira Infancia"},
            {ramal: "6482", unidade: "Departamento", departamento: "Departamento de Atenção a Primeira Infancia", setor: "Departamento de Atenção a Primeira Infancia"},
            {ramal: "6484", unidade: "Departamento", departamento: "Departamento de Atenção a Primeira Infancia", setor: "Departamento de Atenção a Primeira Infancia"},
            {ramal: "6461", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Informática Geral"},
            {ramal: "6464", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimonio e Apoio"},
            {ramal: "6467", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimonio e Apoio"},
            {ramal: "6530", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimonio e Apoio"},
            {ramal: "6569", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimonio e Apoio"},
            {ramal: "6451", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Patrimonio e Apoio"},
            {ramal: "6401", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Orçamento e Finanças"},
            {ramal: "6425", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Orçamento e Finanças - Chefe"},
            {ramal: "6468", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Orçamento e Finanças"},
            {ramal: "6424", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas Nota Fiscal Gaucha"},
            {ramal: "6443", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas"},
            {ramal: "6448", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas"},
            {ramal: "6473", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas"},
            {ramal: "6478", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas"},
            {ramal: "6480", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas"},
            {ramal: "6504", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas Ptc Convenios"},
            {ramal: "6545", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas"},
            {ramal: "6575", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas - Chefe"},
            {ramal: "6434", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas"},
            {ramal: "6492", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "DA - Div. Contratos Convenios e Prest. Contas PTC Parcerias"},
            {ramal: "6437", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Gestão de Pessoas"},
            {ramal: "6494", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Gestão de Pessoas"},
            {ramal: "6436", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Divisão de Gestão de Pessoas"},
            {ramal: "6485", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Direção Administrativa"},
            {ramal: "6486", unidade: "Departamento", departamento: "Departamento Administrativo", setor: "Direção Administrativa"},
            {ramal: "8418", unidade: "Gabinete", departamento: "COPA Gabinete", setor: "Copa 8º Andar"},
            {ramal: "6449", unidade: "Conselho", departamento: "CEI", setor: "Conselho do Idoso"},
            {ramal: "6450", unidade: "Conselho", departamento: "CEI", setor: "Conselho do Idoso"},
            {ramal: "6560", unidade: "Conselho", departamento: "CEI", setor: "Conselho do Idoso"},
            {ramal: "6427", unidade: "Conselho", departamento: "CEAS", setor: "Conselho de Assistência Social"},
            {ramal: "6495", unidade: "Conselho", departamento: "CEAS", setor: "Conselho de Assistência Social"},
            {ramal: "6522", unidade: "Conselho", departamento: "CEAS", setor: "Conselho de Assistência Social"},
            {ramal: "6536", unidade: "Conselho", departamento: "CEAS", setor: "Conselho de Assistência Social"},
            {ramal: "6416", unidade: "Assessoria", departamento: "Assessoria Técnica", setor: "Assessoria Técnica"},
            {ramal: "6493", unidade: "Assessoria", departamento: "Assessoria Técnica", setor: "Assessoria Técnica"},
            {ramal: "6528", unidade: "Assessoria", departamento: "Assessoria Técnica", setor: "Assessoria Técnica"},
            {ramal: "6543", unidade: "Assessoria", departamento: "Assessoria Técnica", setor: "Assessoria Técnica"},
            {ramal: "6421", unidade: "Assessoria", departamento: "Serotial Procuradoria Jutidica SEDES", setor: "Setorial PGE"},
            {ramal: "6422", unidade: "Assessoria", departamento: "Serotial Procuradoria Jutidica SEDES", setor: "Setorial PGE"},
            {ramal: "6477", unidade: "Assessoria", departamento: "Serotial Procuradoria Jutidica SEDES", setor: "Setorial PGE"},
            {ramal: "6415", unidade: "Assessoria", departamento: "Assessoria de Comunicação Social", setor: "Assessoria de Comunicação Social"}
        ];

        // Credenciais de administrador
        const ADMIN_CREDENTIALS = {
            username: "admin",
            password: "sedes2023"
        };

        // Estado da aplicação
        let isAdmin = false;
        let currentEditIndex = -1;

        // Agrupar ramais por departamento - CORRIGIDO
        function groupByDepartment(ramais) {
            const grouped = {};
            ramais.forEach(ramal => {
                const dept = ramal.departamento.trim();
                if (!grouped[dept]) {
                    grouped[dept] = [];
                }
                grouped[dept].push(ramal);
            });
            return grouped;
        }

        // Renderizar os dados na página - CORRIGIDO
        function renderRamais(filteredRamais = ramais) {
            const content = document.getElementById('content');
            const debugInfo = document.getElementById('debugInfo');
            
            // Debug info
            debugInfo.innerHTML = `Total de ramais carregados: ${ramais.length} | Exibindo: ${filteredRamais.length}`;
            
            content.innerHTML = '';
            content.appendChild(debugInfo);
            
            if (filteredRamais.length === 0) {
                content.innerHTML += '<p>Nenhum ramal encontrado.</p>';
                return;
            }
            
            const grouped = groupByDepartment(filteredRamais);
            const departments = Object.keys(grouped).sort();
            
            departments.forEach(departamento => {
                const ramaisDoDepartamento = grouped[departamento];
                const unidade = ramaisDoDepartamento[0].unidade;
                
                const departmentDiv = document.createElement('div');
                departmentDiv.className = 'department';
                departmentDiv.setAttribute('data-unidade', unidade);
                
                const departmentHeader = document.createElement('div');
                departmentHeader.className = 'department-header';
                departmentHeader.innerHTML = `
                    <h2>${departamento}</h2>
                    <span class="toggle-icon">▼</span>
                `;
                
                const departmentContent = document.createElement('div');
                departmentContent.className = 'department-content show'; // Mostrar por padrão
                
                let tableHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>Ramal</th>
                                <th>Setor</th>
                                ${isAdmin ? '<th>Ações</th>' : ''}
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                ramaisDoDepartamento.forEach((ramal) => {
                    const originalIndex = ramais.findIndex(r => 
                        r.ramal === ramal.ramal && 
                        r.departamento === ramal.departamento && 
                        r.setor === ramal.setor
                    );
                    
                    tableHTML += `
                        <tr>
                            <td class="ramal">${ramal.ramal}</td>
                            <td>${ramal.setor}</td>
                            ${isAdmin ? `
                                <td>
                                    <button class="edit-btn" data-index="${originalIndex}">Editar</button>
                                    <button class="delete-btn" data-index="${originalIndex}">Excluir</button>
                                </td>
                            ` : ''}
                        </tr>
                    `;
                });
                
                tableHTML += `
                        </tbody>
                    </table>
                `;
                
                departmentContent.innerHTML = tableHTML;
                
                departmentDiv.appendChild(departmentHeader);
                departmentDiv.appendChild(departmentContent);
                content.appendChild(departmentDiv);
                
                // Adicionar evento de clique para expandir/recolher
                departmentHeader.addEventListener('click', () => {
                    departmentContent.classList.toggle('show');
                    const icon = departmentHeader.querySelector('.toggle-icon');
                    icon.textContent = departmentContent.classList.contains('show') ? '▲' : '▼';
                });
            });
            
            // Adicionar botão de adicionar se for admin
            if (isAdmin) {
                const addButton = document.createElement('button');
                addButton.className = 'add-ramal-btn';
                addButton.textContent = '+ Adicionar Novo Ramal';
                addButton.addEventListener('click', () => {
                    openEditModal();
                });
                content.insertBefore(addButton, content.firstChild);
            }
            
            // Adicionar eventos aos botões de edição e exclusão
            if (isAdmin) {
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        openEditModal(index);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        if (confirm('Tem certeza que deseja excluir este ramal?')) {
                            ramais.splice(index, 1);
                            saveRamais();
                            renderRamais();
                        }
                    });
                });
            }
        }

        // ... (restante das funções permanecem iguais) ...

        // Inicializar a página
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Total de ramais carregados:', ramais.length);
            renderRamais();
            
            // ... (restante do código de inicialização) ...
        });
    </script>
</body>
</html>
